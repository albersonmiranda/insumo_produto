---
title: Insumo-Produto
subtitle: 2¬™ Lista de Exerc√≠cios
author: Alberson da Silva Miranda
date: last-modified
date-format: long
lang: pt-BR
thanks: C√≥digo dispon√≠vel em https://github.com/albersonmiranda/insumo_produto.
toc: true
number-sections: true
sansfont: Times New Roman 
monofont: Fira Code
monofontoptions:
  - Scale=0.8
highlight-style: zenburn
code-line-numbers: true
format:
  pdf:
    documentclass: scrreprt
    header-includes: 
      - \renewcommand\thesubsection{\alph{subsection}}
---

# Dados

Escolha das matrizes vetores:

1. Z: matriz de consumo intermedi√°rio: D6:BB56
2. f: matriz de consumo final: BD6:BJ56
3. x: vetor de produ√ß√£o total: D79:BB79
4. v: vetor de valor adicionado: D78:BB78
5. r: vetor de remunera√ß√£o: D69:BB69. Aqui, optei por apenas as remunera√ß√µes do fator trabalho, pois ser√° endogeneizado o consumo das fam√≠lias. N√£o considerei a al√≠nea Excedente Operacional Bruto e Rendimento Misto Bruto por estarem associadas ao investimento (representada pela *proxy* Forma√ß√£o Bruta de Capital Fixo)
6. e: vetor de ocupa√ß√µes: D80:BB80
7. C: vetor de consumo das fam√≠lias: BH6:BH56
8. m: vetor de importa√ß√µes: D58:BB58
9. E: vetor de exporta√ß√µes: BD6:BD56
10. taxes: vetor de impostos: D59:BB59
11. fcbf: vetor de Forma√ß√£o Bruta de Capital Fixo: D60:BB60

Esses dados foram importados utilizando as primeiras fun√ß√µes do pacote {fio}, dispon√≠vel em https://github.com/albersonmiranda/fio, que incluem a fun√ß√£o `import_element()` para importar elementos de uma matriz insumo-produto (ex.: matriz de transa√ß√µes intermedi√°rias, Z), e as fun√ß√µes `tecnical_coef()` e `leontief_inverse()` para calcular os coeficientes t√©cnicos e a inversa de Leontief, respectivamente.

# Q1

Calcule os multiplicadores da produ√ß√£o do tipo I e tipo II para cada setor de atividade
e decomponha os efeitos direto, indireto e renda. Ap√≥s, identifique os 5 setores com maior efeito
indireto e efeito-renda. Esses setores s√£o os mesmos? Quais fatores poderiam explicar as
diferen√ßas entre os setores segundo o tipo de multiplicador?

## Dados e c√¥mputo da inversa de Leontief

```{r}
# dados
mip = fio::iom_br_2020_51

# matriz de coeficientes t√©cnicos
A = mip |>
  fio::tecnical_coef()

# inversa de Leontief
B = A |>
  fio::leontief_inverse()

# quantidade de setores
n = nrow(B)

# coeficientes do modelo fechado
coef_consumo_familias = mip[["C"]] / sum(mip[["r"]])
coef_remuneracoes = mip[["r"]] / mip[["x"]]

# matriz de coeficientes do modelo fechado
A_fechado = rbind(
  cbind(A, coef_consumo_familias),
  cbind(coef_remuneracoes, 0))

# inversa de Leontief do modelo fechado
B_fechado = solve(diag(n + 1) - A_fechado)
```

## Multiplicadores

Para a compara√ß√£o dos multiplicadores, no modelo fechado optei por usar o efeito total truncado, ou seja, sem considerar o coeficiente de consumo das fam√≠lias no somat√≥rio, deixando apenas os setores produtivos, assim como no c√¥mputo do efeito total do modelo aberto.

```{r}
# multiplicadores
multiplicadores = tibble::tibble(
  setores = rownames(A),
  efeito_total_aberto = colSums(B),
  efeito_total_fechado = colSums(B_fechado[1:n, 1:n]), 
  efeito_direto = colSums(B),
  efeito_indireto = colSums(B) - colSums(A) - 1
) |>
  dplyr::mutate(
    efeito_renda = efeito_total_fechado - efeito_total_aberto
  )
```

```{r}
#| tbl-cap: "Top 5 setores com maior efeito indireto"
#| tbl-pos: H

# top 5 setores com maior efeito indireto
sort_by(
  multiplicadores,
  multiplicadores$efeito_indireto,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

```{r}
#| tbl-cap: "Top 5 setores com maior efeito renda"
#| tbl-pos: H

# top 5 setores com maior efeito renda
sort_by(
  multiplicadores,
  multiplicadores$efeito_renda,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

N√£o, n√£o s√£o os mesmos setores. O efeito indireto √© maior em setores que possuem maior impacto na cadeia produtiva daquela economia. Faz sentido que a ind√∫stria de transforma√ß√£o lidere esse tipo de efeito. J√° o efeito-renda nos diz a taxa em que os benef√≠cios dos efeitos diretos e indiretos s√£o transformados em consumo das fam√≠lias, resultando novamente em demanda para os diversos setores. Setores de maior propen√ß√£o ao consumo tendem a liderar esse tipo de efeito.

# Q2

D√∫vida: faz sentido o modelo fechado (consumo e renda das fam√≠lias) para a an√°lise dos multiplicadores de importa√ß√µes e exporta√ß√µes? Ou ser√° que a forma de fechar √© diferente? Vou deixar o c√°lculo para facilitar o acerto depois, mas acredito que apenas o multiplicador do tipo I ser√° corretamente calculado para essas vari√°veis.

## Multiplicadores para importa√ß√µes

```{r}
#| tbl-cap: "Top 5 setores com maior multiplicador de importa√ß√£o"
#| tbl-pos: H

# coeficiente de importa√ß√µes
coef_import = mip[["m"]] / mip[["x"]]
coef_import = as.vector(coef_import)

# matriz geradora de import
coef_import_hat = diag(coef_import)
M = coef_import_hat %*% B
M_fechado = coef_import_hat %*% B_fechado[1:n, 1:n]

# multiplicadores de import
multiplicadores_import = tibble::tibble(
  setores = rownames(A),
  simples = colSums(M),
  tipo_I = colSums(M) / coef_import,
  totais = colSums(M_fechado),
  tipo_II = colSums(M_fechado) / coef_import
)

# top 5 setores com maior multiplicador direto e indireto
sort_by(
  multiplicadores_import,
  multiplicadores_import$tipo_I,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

## Multiplicadores para impostos

```{r}
#| tbl-cap: "Top 5 setores com maior multiplicador de impostos"
#| tbl-pos: H

# coeficiente de impostos
coef_taxes = mip[["m"]] / mip[["x"]]
coef_taxes = as.vector(coef_taxes)

# matriz geradora de impostos
coef_taxes_hat = diag(coef_taxes)
taxes = coef_taxes_hat %*% B
taxes_fechado = coef_taxes_hat %*% B_fechado[1:n, 1:n]

# multiplicadores de impostos
multiplicadores_taxes = tibble::tibble(
  setores = rownames(A),
  simples = colSums(taxes),
  tipo_I = colSums(taxes) / coef_taxes,
  totais = colSums(taxes_fechado),
  tipo_II = colSums(taxes_fechado) / coef_taxes
)

# top 5 setores com maior multiplicador direto e indireto
sort_by(
  multiplicadores_taxes,
  multiplicadores_taxes$tipo_I,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

## Multiplicadores para emprego

```{r}
#| tbl-cap: "Top 5 setores com maior multiplicador de emprego"
#| tbl-pos: H

# coeficiente de emprego
coef_emprego = mip[["e"]] / mip[["x"]]
coef_emprego = as.vector(coef_emprego)

# matriz geradora de emprego
coef_emprego_hat = diag(coef_emprego)
E = coef_emprego_hat %*% B
E_fechado = coef_emprego_hat %*% B_fechado[1:n, 1:n]

# multiplicadores de emprego
multiplicadores_emprego = tibble::tibble(
  setores = rownames(A),
  simples = colSums(E),
  tipo_I = colSums(E) / coef_emprego,
  totais = colSums(E_fechado),
  tipo_II = colSums(E_fechado) / coef_emprego
)

# top 5 setores com maior multiplicador induzido
sort_by(
  multiplicadores_emprego,
  multiplicadores_emprego$tipo_II,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

# Q3

$$
\begin{aligned}
  0.75 \times 13.4 &= 10.05 \rightarrow \text{desemprego alvo} \\
  13.4 - 10.05 &= 3.35 \rightarrow \text{postos de trabalho necess√°rios}
\end{aligned}
$$ {#eq-q3}

```{r}
# m√©dia multiplicadores de emprego
medias_emprego = sapply(multiplicadores_emprego[, sapply(multiplicadores_emprego, is.numeric)], function(multiplicador) {
  mean(multiplicador, na.rm = TRUE)
})

# investimento necess√°rio
3350000 / medias_emprego
```

O multiplicador ideal seria o tipo I. Isso porque o posto de trabalho, sendo uma unidade f√≠sica, n√£o pode ser fracionada. O multiplicador do tipo I nos d√° a quantidade de empregos gerados direto e indireto, que s√£o as possibilidades de empregos que podem ser gerados.

# Q4

Para cada um dos cen√°rios abaixo, calcule o impacto sobre a produ√ß√£o de cada setor:

1. Um aumento de 15,65% nas exporta√ß√µes de petr√≥leo
1. Um aumento de 0,36% no consumo das fam√≠lias
1. Um aumento nos investimentos (FBCF) equivalente a R$ 8 bilh√µes

## Impacto de exporta√ß√µes de petr√≥leo

```{r}
#| tbl-cap: "Top 5 setores com maior impacto de exporta√ß√µes de petr√≥leo, tipo I"
#| tbl-pos: H

# coeficiente de exporta√ß√µes
coef_export = mip[["E"]] / t(mip[["x"]])
coef_export = as.vector(coef_export)

# matriz geradora de exporta√ß√µes
coef_export_hat = diag(coef_export)
X = coef_export_hat %*% B
X_fechado = coef_export_hat %*% B_fechado[1:n, 1:n]

# multiplicadores de exporta√ß√µes
multiplicadores_export = tibble::tibble(
  setores = rownames(A),
  simples = colSums(X),
  tipo_I = colSums(X) / coef_export,
  totais = colSums(X_fechado),
  tipo_II = colSums(X_fechado) / coef_export
)

# choque no petr√≥leo (1979 üíÄ)
choque_petroleo = 1.1565 * mip[["E"]]

# impacto setorial
multiplicadores_export = multiplicadores_export |>
  dplyr::mutate(
    impacto_tipo_I = choque_petroleo / tipo_I,
    impacto_tipo_II = choque_petroleo / tipo_II
  )

# top 5 setores com maior multiplicador tipo I
multiplicadores_export |>
sort_by(
  multiplicadores_export$impacto_tipo_I,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

## Impacto do consumo das fam√≠lias

```{r}
#| tbl-cap: "Top 5 setores com maior impacto do consumo das fam√≠lias, tipo I"
#| tbl-pos: H

# coeficiente de consumo
coef_consumo = mip[["C"]] / t(mip[["x"]])
coef_consumo = as.vector(coef_consumo)

# matriz geradora de consumo
coef_consumo_hat = diag(coef_consumo)
consumo = coef_consumo_hat %*% B
consumo_fechado = coef_consumo_hat %*% B_fechado[1:n, 1:n]

# multiplicadores de exporta√ß√µes
multiplicadores_consumo = tibble::tibble(
  setores = rownames(A),
  simples = colSums(consumo),
  tipo_I = colSums(consumo) / coef_consumo,
  totais = colSums(consumo_fechado),
  tipo_II = colSums(consumo_fechado) / coef_consumo
)

# choque no consumo
choque_consumo = 1.0036 * mip[["C"]]

# impacto setorial
multiplicadores_consumo = multiplicadores_consumo |>
  dplyr::mutate(
    impacto_tipo_I = choque_consumo / tipo_I,
    impacto_tipo_II = choque_consumo / tipo_II
  )

# top 5 setores com maior multiplicador tipo I
multiplicadores_consumo |>
sort_by(
  multiplicadores_consumo$impacto_tipo_I,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```

## Impacto da FBCF

```{r}
#| tbl-cap: "Top 5 setores com maior impacto de investimento, tipo I"
#| tbl-pos: H

# coeficiente de investimento
coef_investimento = mip[["fbcf"]] / t(mip[["x"]])
coef_investimento = as.vector(coef_investimento)

# matriz geradora de investimento
coef_investimento_hat = diag(coef_investimento)
investimento = coef_investimento_hat %*% B
investimento_fechado = coef_investimento_hat %*% B_fechado[1:n, 1:n]

# multiplicadores de exporta√ß√µes
multiplicadores_investimento = tibble::tibble(
  setores = rownames(A),
  simples = colSums(investimento),
  tipo_I = colSums(investimento) / coef_investimento,
  totais = colSums(investimento_fechado),
  tipo_II = colSums(investimento_fechado) / coef_investimento
)

# choque no investimento
choque_investimento = 8000

# impacto setorial
multiplicadores_investimento = multiplicadores_investimento |>
  dplyr::mutate(
    impacto_tipo_I = choque_investimento / tipo_I,
    impacto_tipo_II = choque_investimento / tipo_II
  )

# top 5 setores com maior multiplicador tipo I
multiplicadores_investimento |>
sort_by(
  multiplicadores_investimento$impacto_tipo_I,
  decreasing = TRUE
) |>
  head(5) |>
  kableExtra::kbl(booktabs = TRUE, digits = 3) |>
  kableExtra::kable_styling(latex_options = c("striped", "scale_down"))
```